<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Is That You???</title>
    <!-- Library Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Great+Vibes&display=swap"
      rel="stylesheet" />
    <style>
      :root {
        --primary: #ff4d6d;
        --secondary: #ff8fa3;
        --bg-color: #fff0f3;
        --card-bg: rgba(
          255,
          255,
          255,
          0.6
        ); /* Lebih transparan untuk efek blur */
        --text-color: #590d22;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }

      body {
        background-color: var(--bg-color);
        color: var(--text-color);
        overflow-x: hidden;
        position: relative;
        min-height: 100vh;
      }

      /* --- NEW: BLURRY SHAPES BACKGROUND --- */
      .blob-cont {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        z-index: -2; /* Mundur biar gak nutupin partikel */
        overflow: hidden;
      }
      .blob {
        position: absolute;
        border-radius: 50%;
        filter: blur(80px);
        opacity: 0.6;
        animation: floatBlob 10s infinite alternate;
      }
      .blob-1 {
        top: -10%;
        left: -10%;
        width: 50vw;
        height: 50vw;
        background: #ffccd5;
        animation-delay: 0s;
      }
      .blob-2 {
        bottom: -10%;
        right: -10%;
        width: 60vw;
        height: 60vw;
        background: #ffb3c1;
        animation-delay: 2s;
      }
      .blob-3 {
        top: 40%;
        left: 40%;
        width: 40vw;
        height: 40vw;
        background: #ffe5ec;
        animation-delay: 4s;
      }
      @keyframes floatBlob {
        0% {
          transform: translate(0, 0) scale(1);
        }
        100% {
          transform: translate(20px, 40px) scale(1.1);
        }
      }

      /* --- GLOBAL PARTICLES --- */
      #particles-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1; /* Di atas blob, di bawah konten */
        pointer-events: none;
      }

      /* --- UTILITIES --- */
      .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        position: relative;
        z-index: 1;
      }

      .section-title {
        font-family: "Great Vibes", cursive;
        font-size: 3.5rem;
        color: var(--primary);
        text-align: center;
        margin-bottom: 20px;
        text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.5);
      }

      /* --- ANIMATION --- */
      .scroll-reveal {
        transition: all 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      }
      .hidden-section {
        opacity: 0;
        transform: translateY(80px) scale(0.9);
        filter: blur(8px);
      }
      .visible-section {
        opacity: 1;
        transform: translateY(0) scale(1);
        filter: blur(0);
      }

      /* --- LOGIN SCREEN (IMPROVED) --- */
      #login-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        /* Ganti gradient solid dengan transparan agar blob & partikel terlihat */
        background: rgba(255, 240, 243, 0.3);
        backdrop-filter: blur(5px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.8s ease;
        overflow: hidden;
      }

      .login-box {
        position: relative;
        z-index: 10;
        /* Glassmorphism Effect yang lebih kuat */
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.8);
        padding: 3rem;
        border-radius: 25px;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        text-align: center;
        width: 90%;
        max-width: 400px;
        animation: floatLogin 6s ease-in-out infinite;
      }

      @keyframes floatLogin {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .login-box h1 {
        font-family: "Great Vibes", cursive;
        font-size: 3.5rem;
        background: linear-gradient(to right, #ff4d6d, #ff8fa3);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 10px;
        filter: drop-shadow(0px 2px 2px rgba(255, 255, 255, 0.5));
      }

      .login-input {
        width: 100%;
        padding: 15px;
        border: 2px solid rgba(255, 255, 255, 0.5);
        border-radius: 50px;
        margin: 25px 0;
        text-align: center;
        font-size: 1.1rem;
        outline: none;
        transition: 0.3s;
        background: rgba(255, 255, 255, 0.6);
        color: var(--text-color);
        box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
      }

      .login-input:focus {
        border-color: var(--primary);
        background: white;
        transform: scale(1.02);
      }

      .btn-main {
        background: linear-gradient(45deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        padding: 15px 40px;
        border-radius: 50px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 10px 20px rgba(255, 77, 109, 0.3);
      }

      .btn-main:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 15px 30px rgba(255, 77, 109, 0.5);
      }

      /* --- MAIN CONTENT --- */
      #main-content {
        display: none;
      }

      .hero {
        height: 80vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
      }

      #typing-text {
        font-weight: 600;
        color: var(--primary);
        border-right: 3px solid var(--primary);
        padding-right: 5px;
        animation: blink 0.7s infinite;
      }

      @keyframes blink {
        50% {
          border-color: transparent;
        }
      }

      /* --- TIMER BOX (FIXED ALIGNMENT) --- */
      .timer-box {
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        padding: 25px;
        border-radius: 15px;
        text-align: center;
        margin: 20px auto 50px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        max-width: 600px;
        border: 2px solid var(--secondary);
      }

      .timer-title {
        font-size: 1.1rem;
        margin-bottom: 15px;
        color: #777;
      }

      .timer-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr); /* Maksa 4 kolom sejajar */
        gap: 10px;
        justify-items: center;
      }

      .timer-item {
        background: #fff0f3;
        padding: 10px 5px;
        border-radius: 10px;
        width: 100%;
        border: 1px solid var(--secondary);
      }

      .timer-number {
        display: block;
        font-size: 1.8rem;
        font-weight: bold;
        color: var(--primary);
        line-height: 1;
      }

      .timer-label {
        font-size: 0.8rem;
        color: var(--text-color);
      }

      /* Mobile adjustment for timer */
      @media (max-width: 480px) {
        .timer-number {
          font-size: 1.4rem;
        }
        .timer-label {
          font-size: 0.7rem;
        }
        .timer-grid {
          gap: 5px;
        }
      }

      /* Letter */
      .letter-container {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        margin: 50px auto;
        position: relative;
        transform: rotate(-1deg);
        border: 1px solid #ffe5ec;
      }

      .letter-container::before {
        content: "üíå";
        position: absolute;
        top: -25px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 3rem;
      }

      /* Typing cursor for letter */
      #letter-content::after {
        content: "|";
        animation: blink 1s infinite;
        color: var(--primary);
      }

      /* --- NEW: SCRATCH CARD (KUPON) --- */
      .scratch-container {
        position: relative;
        width: 300px;
        height: 150px;
        margin: 40px auto;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        border: 2px dashed var(--primary);
        background: white;
        text-align: center;
        user-select: none;
      }
      .secret-prize {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1;
        background: #fff;
      }
      .prize-text {
        font-family: "Great Vibes", cursive;
        font-size: 2rem;
        color: var(--primary);
        margin-top: 10px;
      }
      #scratch-canvas {
        position: absolute;
        top: 0;
        left: 0;
        z-index: 2;
        cursor:
          url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2"><circle cx="12" cy="12" r="10"/></svg>')
            12 12,
          auto;
        touch-action: none;
      }

      /* --- NEW: PLAYLIST --- */
      .playlist-box {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        padding: 20px;
        border-radius: 15px;
        border: 1px solid #ffe5ec;
        margin: 40px auto;
        max-width: 600px;
      }
      .playlist-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }
      .album-cover {
        width: 60px;
        height: 60px;
        background: var(--primary);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        color: white;
      }
      .song-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px;
        border-radius: 10px;
        transition: background 0.2s;
        cursor: pointer;
        margin-bottom: 5px;
      }
      .song-item:hover {
        background: rgba(255, 255, 255, 0.5);
      }
      .song-info h4 {
        font-size: 1rem;
        margin-bottom: 2px;
      }
      .song-info p {
        font-size: 0.8rem;
        color: #777;
      }
      .play-icon {
        font-size: 1.2rem;
        color: var(--primary);
      }

      /* Gallery */
      .gallery-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 20px;
        margin: 40px 0;
      }

      .polaroid {
        background: white;
        padding: 10px 10px 40px 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transform: rotate(var(--r));
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        cursor: pointer;
        position: relative;
      }

      /* New Interaction: Pop effect without modal */
      .polaroid:active,
      .polaroid:focus {
        transform: scale(1.15) rotate(0deg) !important;
        z-index: 50;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
      }

      .polaroid img {
        width: 100%;
        border-radius: 3px;
        pointer-events: none; /* Mencegah drag gambar */
      }

      /* Game Area */
      #game-area {
        background: linear-gradient(
          to bottom,
          rgba(255, 240, 243, 0.8),
          rgba(255, 229, 236, 0.8)
        );
        backdrop-filter: blur(5px);
        border-radius: 20px;
        padding: 20px;
        text-align: center;
        border: 4px solid white;
        box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.05);
        margin: 50px 0;
        position: relative;
        overflow: hidden;
        height: 350px;
      }

      .target-heart {
        position: absolute;
        font-size: 2.5rem;
        cursor: pointer;
        animation: float 2s infinite ease-in-out;
        user-select: none;
        transition: transform 0.1s;
      }
      .target-heart:active {
        transform: scale(0.8);
      }

      /* WA & Music Button */
      .wa-container {
        text-align: center;
        margin: 80px 0;
      }
      .wa-btn {
        background: #25d366;
        color: white;
        text-decoration: none;
        padding: 15px 40px;
        border-radius: 50px;
        font-size: 1.2rem;
        font-weight: bold;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 10px 20px rgba(37, 211, 102, 0.4);
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      /* Floating Music Control */
      .music-control {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: white;
        padding: 10px;
        border-radius: 50%;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        z-index: 1000;
        font-size: 1.5rem;
        border: 2px solid var(--primary);
        display: none; /* Muncul setelah login */
        animation: spin 4s linear infinite;
      }
      @keyframes spin {
        100% {
          transform: rotate(360deg);
        }
      }

      /* --- NEW: BEAUTIFUL FOOTER --- */
      .site-footer {
        margin-top: 80px;
        padding: 30px 10px;
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-top: 1px solid rgba(255, 255, 255, 0.8);
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .footer-content p {
        margin: 5px 0;
        color: var(--text-color);
        font-size: 0.9rem;
      }

      .footer-heart {
        color: var(--primary);
        display: inline-block;
        animation: heartBeat 1.2s infinite;
      }

      @keyframes heartBeat {
        0% {
          transform: scale(1);
        }
        25% {
          transform: scale(1.3);
        }
        50% {
          transform: scale(1);
        }
        75% {
          transform: scale(1.3);
        }
        100% {
          transform: scale(1);
        }
      }

      .footer-credit {
        font-family: "Great Vibes", cursive;
        font-size: 1.4rem;
        color: var(--secondary);
      }
    </style>
  </head>
  <body>
    <!-- Background Blobs -->
    <div class="blob-cont">
      <div class="blob blob-1"></div>
      <div class="blob blob-2"></div>
      <div class="blob blob-3"></div>
    </div>

    <!-- PARTICLE BACKGROUND (Now Global) -->
    <canvas id="particles-canvas"></canvas>

    <!-- Audio (FIXED: Type changed to audio/mpeg) -->
    <audio id="bgMusic" loop>
      <source src="audio2.mp3" type="audio/mpeg" />
    </audio>

    <!-- Music Control Button -->
    <div id="musicBtn" class="music-control" onclick="toggleMusic()">üéµ</div>

    <!-- Login Section -->
    <div id="login-screen">
      <!-- Removed canvas from here, now it's global -->
      <div class="login-box">
        <h1>Login</h1>
        <p>Who are you???</p>
        <input
          type="text"
          id="nameInput"
          class="login-input"
          placeholder="Your Full Name..." />
        <button class="btn-main" onclick="attemptLogin()">
          Enter My Heart
        </button>
        <p
          id="error-msg"
          style="
            color: #d00000;
            font-size: 0.9rem;
            margin-top: 10px;
            display: none;
          ">
          Sorry, access denied. Only for my angel.
        </p>
      </div>
    </div>

    <!-- Main Content -->
    <div id="main-content">
      <div class="hero container visible-section">
        <h1 class="section-title" style="font-size: 4rem">
          Happy Valentine's Day!
        </h1>
        <h2>To my dearest, <br /><span id="typing-text"></span></h2>
      </div>

      <!-- NEW: REALTIME CLOCK SECTION (FIXED LAYOUT) -->
      <div class="container scroll-reveal">
        <div class="timer-box">
          <p class="timer-title">We have been loving each other for:</p>
          <div class="timer-grid">
            <div class="timer-item">
              <span class="timer-number" id="days">0</span>
              <span class="timer-label">Days</span>
            </div>
            <div class="timer-item">
              <span class="timer-number" id="hours">00</span>
              <span class="timer-label">Hours</span>
            </div>
            <div class="timer-item">
              <span class="timer-number" id="minutes">00</span>
              <span class="timer-label">Minutes</span>
            </div>
            <div class="timer-item">
              <span class="timer-number" id="seconds">00</span>
              <span class="timer-label">Seconds</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Letter (Typing Animation) -->
      <div class="container scroll-reveal" id="letter-section">
        <div class="letter-container">
          <h3
            style="
              text-align: center;
              margin-bottom: 20px;
              color: var(--primary);
            ">
            A Letter For You
          </h3>
          <!-- Teks akan muncul otomatis disini -->
          <p
            id="letter-content"
            style="
              line-height: 1.8;
              text-align: justify;
              white-space: pre-line;
            "></p>
        </div>
      </div>

      <!-- NEW: SCRATCH CARD (KUPON) -->
      <div class="container scroll-reveal">
        <h2 class="section-title" style="font-size: 2.5rem">
          Scratch This Card!
        </h2>
        <p style="text-align: center; color: #777">Gosok pelan-pelan yaa...</p>

        <div class="scratch-container">
          <!-- Hadiah Tersembunyi -->
          <div class="secret-prize">
            <div class="prize-text">I Love You Moreee.</div>
            <p style="font-size: 0.8rem; color: #aaa">Natasha Aurellia</p>
          </div>
          <!-- Canvas Penutup -->
          <canvas id="scratch-canvas" width="300" height="150"></canvas>
        </div>
      </div>

      <!-- NEW: PLAYLIST (OUR SONGS) -->
      <div class="container scroll-reveal">
        <div class="playlist-box">
          <div class="playlist-header">
            <div class="album-cover">üéº</div>
            <div>
              <h3 style="color: var(--primary)">Our Playlist</h3>
              <p style="font-size: 0.8rem">A song that reminds me of you</p>
            </div>
          </div>

          <div
            class="song-item"
            onclick="
              window.open(
                'https://open.spotify.com/track/1vkTwwAwzVVin3wqye5w1k?si=18c79baeaf4140c9',
                '_blank',
              )
            ">
            <div class="song-info">
              <h4>Hey, I'm tired</h4>
              <p>Arash Buana</p>
            </div>
            <div class="play-icon">‚ñ∂</div>
          </div>
          <div
            class="song-item"
            onclick="
              window.open(
                'https://open.spotify.com/track/0pNFrM5L0te1EXGxveeYiR?si=2042c56849e74662',
                '_blank',
              )
            ">
            <div class="song-info">
              <h4>My You</h4>
              <p>Jung Kook</p>
            </div>
            <div class="play-icon">‚ñ∂</div>
          </div>
          <div
            class="song-item"
            onclick="
              window.open(
                'https://open.spotify.com/track/4hZUa0IFUOHhvZhK1YwXHu?si=67e7eee70e6e4f2e',
                '_blank',
              )
            ">
            <div class="song-info">
              <h4>Forever Star(„ÄäÂÅ∑ÂÅ∑Ëóè‰∏ç‰Ωè„ÄãÁîµËßÜÂâßÊèíÊõ≤)</h4>
              <p>Âº†Ê¥¢Ë±™ (Yi Hao Zhang)</p>
            </div>
            <div class="play-icon">‚ñ∂</div>
          </div>
        </div>
      </div>

      <!-- Gallery (Interaction Only, No Modal) -->
      <div class="container scroll-reveal">
        <h2 class="section-title">Our Memories</h2>
        <p style="text-align: center; font-size: 0.9rem; color: #777">
          (Tap the photo to feel the love!)
        </p>
        <div class="gallery-grid">
          <!-- PASTE FOTO KAMU DI SINI (Full 8 Items restored) -->
          <div class="polaroid" style="--r: -3deg">
            <img src="gambar/1.jpeg" alt="Memory" class="gallery-img" />
          </div>
          <div class="polaroid" style="--r: 2deg">
            <img src="gambar/2.jpeg" alt="Memory" class="gallery-img" />
          </div>
          <div class="polaroid" style="--r: -1deg">
            <img src="gambar/3.jpeg" alt="Memory" class="gallery-img" />
          </div>
          <div class="polaroid" style="--r: 4deg">
            <img src="gambar/4.jpeg" alt="Memory" class="gallery-img" />
          </div>
          <div class="polaroid" style="--r: -3deg">
            <img src="gambar/5.jpeg" alt="Memory" class="gallery-img" />
          </div>
          <div class="polaroid" style="--r: 2deg">
            <img src="gambar/9.jpeg" alt="Memory" class="gallery-img" />
          </div>
          <div class="polaroid" style="--r: -1deg">
            <img src="gambar/6.jpeg" alt="Memory" class="gallery-img" />
          </div>
          <div class="polaroid" style="--r: 4deg">
            <img src="gambar/8.jpeg" alt="Memory" class="gallery-img" />
          </div>
        </div>
      </div>

      <!-- Game -->
      <div class="container scroll-reveal">
        <h2 class="section-title">Let's Play!</h2>
        <p style="text-align: center; margin-bottom: 10px">
          Catch <strong>5 Hearts</strong> to unlock the final surprise!
        </p>
        <p style="text-align: center">
          Score: <span id="score-board">0</span>/5
        </p>
        <div id="game-area">
          <div
            id="start-overlay"
            style="
              position: absolute;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: rgba(255, 255, 255, 0.8);
              display: flex;
              justify-content: center;
              align-items: center;
              z-index: 10;
            ">
            <button class="btn-main" onclick="startGame()">Start Game</button>
          </div>
        </div>
      </div>

      <!-- Final WA -->
      <div
        id="final-surprise"
        class="container hidden-section wa-container"
        style="display: none">
        <h2 class="section-title">You Did It!</h2>
        <p style="margin-bottom: 30px; font-size: 1.2rem">
          Tunggu gift dari aku sampai yaa, masih di perjalanan soalnya
        </p>
        <a
          href="https://wa.me/6285718560391?text=Yes!"
          class="wa-btn"
          target="_blank"
          >Will You Be My Valentine?</a
        >
      </div>

      <!-- NEW FOOTER SECTION -->
      <footer class="site-footer">
        <div class="container footer-content">
          <p>Made with <span class="footer-heart">‚ù§Ô∏è</span> and lots of love</p>
          <p class="footer-credit">Only for Natasha Aurellia</p>
          <p style="font-size: 0.75rem; opacity: 0.7; margin-top: 10px">
            &copy; 2026 - Forever Yours, Azzam
          </p>
        </div>
      </footer>
    </div>

    <script>
      /* --- CONFIGURATION --- */
      const correctName = "natasha aurellia";

      // 1. TANGGAL JADIAN (3 APRIL 2023)
      const startDate = new Date("2023-04-03T00:00:00");

      /* --- GLOBAL PARTICLES LOGIC --- */
      const canvas = document.getElementById("particles-canvas");
      const ctx = canvas.getContext("2d");
      let particlesArray;

      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      window.addEventListener("resize", () => {
        resizeCanvas();
        initParticles();
      });
      resizeCanvas(); // Call initial resize

      class Particle {
        constructor() {
          this.x = Math.random() * canvas.width;
          this.y = Math.random() * canvas.height;
          // Partikel lebih halus dan kecil untuk background
          this.size = Math.random() * 3 + 0.5;
          this.speedX = Math.random() * 1 - 0.5;
          this.speedY = Math.random() * 1 - 0.5;
          this.color = `rgba(255, 255, 255, ${Math.random() * 0.4 + 0.2})`;
        }
        update() {
          this.x += this.speedX;
          this.y += this.speedY;
          if (this.x > canvas.width) this.x = 0;
          else if (this.x < 0) this.x = canvas.width;
          if (this.y > canvas.height) this.y = 0;
          else if (this.y < 0) this.y = canvas.height;
        }
        draw() {
          ctx.fillStyle = this.color;
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          ctx.fill();
        }
      }
      function initParticles() {
        particlesArray = [];
        const count = canvas.width < 768 ? 60 : 120; // Jumlah partikel
        for (let i = 0; i < count; i++) particlesArray.push(new Particle());
      }
      function animateParticles() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < particlesArray.length; i++) {
          particlesArray[i].update();
          particlesArray[i].draw();
        }
        requestAnimationFrame(animateParticles);
      }
      initParticles();
      animateParticles();

      // Login & Flow
      function attemptLogin() {
        const inputName = document
          .getElementById("nameInput")
          .value.toLowerCase()
          .trim();
        const errorMsg = document.getElementById("error-msg");
        const music = document.getElementById("bgMusic");
        const musicBtn = document.getElementById("musicBtn");

        if (inputName === correctName) {
          document.getElementById("login-screen").style.opacity = "0";
          setTimeout(() => {
            document.getElementById("login-screen").style.display = "none";
            document.getElementById("main-content").style.display = "block";
            musicBtn.style.display = "block";
            music.play().catch((e) => console.log("Audio need interaction"));
            typeWriter();

            // Start Realtime Clock
            setInterval(updateClock, 1000);
            updateClock(); // Run immediately

            initScrollReveal();
            initScratchCard(); // Init Scratch Card
          }, 800);
        } else {
          errorMsg.style.display = "block";
          const box = document.querySelector(".login-box");
          box.style.transform = "translateX(10px)";
          setTimeout(() => (box.style.transform = "translateX(-10px)"), 100);
          setTimeout(() => (box.style.transform = "translateX(0)"), 200);
        }
      }

      // Typing Effect for Header
      const textToType = "Natasha Aurellia";
      let i = 0;
      function typeWriter() {
        if (i < textToType.length) {
          document.getElementById("typing-text").innerHTML +=
            textToType.charAt(i);
          i++;
          setTimeout(typeWriter, 100);
        }
      }

      // --- LETTER TYPING ANIMATION LOGIC ---
      const fullLetterText = `My Dearest Natasha,\n\nHappy Valentine‚Äôs Day, my love. üíì\n\nI made this little surprise because ordinary words could never fully express how much you mean to me. Thank you for being the reason behind my smiles, for turning ordinary days into beautiful memories. Having you in my life is the greatest blessing I could ever ask for.\n\nAnd if life gave me the chance to choose again a thousand times. I would still choose you. Over and over. In every lifetime.\n\nForever yours,\n- Azzam`;

      let letterIndex = 0;
      let isTypingLetter = false;

      function typeLetter() {
        if (letterIndex < fullLetterText.length) {
          document.getElementById("letter-content").textContent +=
            fullLetterText.charAt(letterIndex);
          letterIndex++;
          setTimeout(typeLetter, 1); // Kecepatan mengetik
        } else {
          // Hilangkan kursor setelah selesai
          const style = document.createElement("style");
          style.innerHTML = "#letter-content::after { display: none; }";
          document.head.appendChild(style);
        }
      }

      // --- REALTIME CLOCK LOGIC ---
      function updateClock() {
        const now = new Date();
        const diff = now - startDate; // Difference in milliseconds

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
        const minutes = Math.floor((diff / (1000 * 60)) % 60);
        const seconds = Math.floor((diff / 1000) % 60);

        document.getElementById("days").innerText = days;
        document.getElementById("hours").innerText =
          hours < 10 ? "0" + hours : hours;
        document.getElementById("minutes").innerText =
          minutes < 10 ? "0" + minutes : minutes;
        document.getElementById("seconds").innerText =
          seconds < 10 ? "0" + seconds : seconds;
      }

      // --- SCRATCH CARD LOGIC ---
      function initScratchCard() {
        const scCanvas = document.getElementById("scratch-canvas");
        const ctxSc = scCanvas.getContext("2d");
        const w = scCanvas.width;
        const h = scCanvas.height;

        // Fill with overlay color/text
        ctxSc.fillStyle = "#ffb3c1"; // Warna penutup
        ctxSc.fillRect(0, 0, w, h);

        ctxSc.fillStyle = "#fff";
        ctxSc.font = "20px Poppins";
        ctxSc.textAlign = "center";
        ctxSc.fillText("Gosok di sini...", w / 2, h / 2 + 5);

        let isDrawing = false;

        function getMousePos(canvas, evt) {
          const rect = canvas.getBoundingClientRect();
          return {
            x: (evt.clientX - rect.left) * (canvas.width / rect.width),
            y: (evt.clientY - rect.top) * (canvas.height / rect.height),
          };
        }

        function scratch(x, y) {
          ctxSc.globalCompositeOperation = "destination-out";
          ctxSc.beginPath();
          ctxSc.arc(x, y, 20, 0, Math.PI * 2, false);
          ctxSc.fill();
        }

        // Mouse Events
        scCanvas.addEventListener("mousedown", (e) => {
          isDrawing = true;
        });
        scCanvas.addEventListener("mouseup", () => {
          isDrawing = false;
        });
        scCanvas.addEventListener("mousemove", (e) => {
          if (!isDrawing) return;
          const pos = getMousePos(scCanvas, e);
          scratch(pos.x, pos.y);
        });

        // Touch Events (Mobile)
        scCanvas.addEventListener(
          "touchstart",
          (e) => {
            isDrawing = true;
            e.preventDefault();
          },
          { passive: false },
        );
        scCanvas.addEventListener("touchend", () => {
          isDrawing = false;
        });
        scCanvas.addEventListener(
          "touchmove",
          (e) => {
            if (!isDrawing) return;
            e.preventDefault(); // Mencegah scroll layar saat gosok
            const touch = e.touches[0];
            const rect = scCanvas.getBoundingClientRect();
            const x =
              (touch.clientX - rect.left) * (scCanvas.width / rect.width);
            const y =
              (touch.clientY - rect.top) * (scCanvas.height / rect.height);
            scratch(x, y);
          },
          { passive: false },
        );
      }

      // Scroll Reveal & Trigger Letter Typing
      function initScrollReveal() {
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add("visible-section");
                entry.target.classList.remove("hidden-section");

                // Trigger typing if letter section is visible
                if (entry.target.id === "letter-section" && !isTypingLetter) {
                  isTypingLetter = true;
                  setTimeout(typeLetter, 500); // Delay sedikit sebelum mulai ngetik
                }
              } else {
                // Optional: Don't hide letter to prevent re-typing
                if (entry.target.id !== "letter-section") {
                  entry.target.classList.remove("visible-section");
                  entry.target.classList.add("hidden-section");
                }
              }
            });
          },
          { threshold: 0.15 },
        );
        document.querySelectorAll(".scroll-reveal").forEach((el) => {
          el.classList.add("hidden-section");
          observer.observe(el);
        });
      }

      // Game & Confetti
      let score = 0;
      let gameActive = false;
      function startGame() {
        document.getElementById("start-overlay").style.display = "none";
        gameActive = true;
        spawnHeart();
      }
      function spawnHeart() {
        if (!gameActive || score >= 5) return;
        const area = document.getElementById("game-area");
        const heart = document.createElement("div");
        heart.innerHTML = "‚ù§Ô∏è";
        heart.className = "target-heart";
        heart.style.left = Math.random() * (area.clientWidth - 50) + "px";
        heart.style.top = Math.random() * (area.clientHeight - 50) + "px";
        heart.onclick = () => {
          score++;
          document.getElementById("score-board").innerText = score;
          heart.remove();
          if (score >= 5) endGame();
          else spawnHeart();
        };
        area.appendChild(heart);
      }
      function endGame() {
        gameActive = false;
        document.getElementById("game-area").innerHTML =
          "<h3 style='margin-top:130px; color:#ff4d6d'>Hebat Sayanggg!!!</h3>";
        triggerConfetti();
        const surprise = document.getElementById("final-surprise");
        surprise.style.display = "block";
        setTimeout(() => {
          surprise.classList.add("visible-section");
          surprise.classList.remove("hidden-section");
          surprise.scrollIntoView({ behavior: "smooth" });
        }, 100);
      }

      function triggerConfetti() {
        const duration = 3000;
        const end = Date.now() + duration;
        (function frame() {
          confetti({
            particleCount: 5,
            angle: 60,
            spread: 55,
            origin: { x: 0 },
          });
          confetti({
            particleCount: 5,
            angle: 120,
            spread: 55,
            origin: { x: 1 },
          });
          if (Date.now() < end) requestAnimationFrame(frame);
        })();
      }

      // Music Toggle
      function toggleMusic() {
        const music = document.getElementById("bgMusic");
        const btn = document.getElementById("musicBtn");
        if (music.paused) {
          music.play();
          btn.innerHTML = "üéµ";
          btn.style.animation = "spin 4s linear infinite";
        } else {
          music.pause();
          btn.innerHTML = "üîá";
          btn.style.animation = "none";
        }
      }
    </script>
  </body>
</html>


